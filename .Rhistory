packrat::restore()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?paste0
paste0("LA:"," Teresa")
paste0("LA:",": Teresa")
runApp()
runApp()
areas_of_learning
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
?selectInput
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
get_graph_title <- function(LA, C="",group="", neighbour_gap_context,GLD_or_AoL_or_take_up="",Percent_or_Gap="",AoL_type="",gap_type="",take_up_ages=""){
# The purpose of this function is to give the graph titles for the neighbours and neighbours gaps graph as well as the context graph
# Variables
#   LA                      - user selected LA
#   neighbour_gap_context   - takes values "neighbour", "neighbour_gap", "context"
#   Percent_or_Gap          - "Percent"
#   AoL_type                - Takes the user selected AoL Type
#   gap_type                - For FSM only, takes user selected gap type
#   take_up_ages            - For take up, takes user selected age range
# Examples
# title_gld<- get_graph_title(LA="Bury", group="FSM", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="GLD",gap_type="National average: gap with FSM children")
# title_gld_2<- get_graph_title(LA="Bury", group="All", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="GLD")
# title_aol<- get_graph_title(LA="Bury", group="All", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="AoL")
# title_aol_2<- get_graph_title(LA="Bury", group="FSM", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="AoL",AoL_type = "CL",gap_type="National average: gap with FSM children")
group_type<-if_else(group=="All Other","All_Other"
,if_else(group=="All","All",group))
title_group=if_else(group_type=="FSM","children known to be eligible for FSM",
if_else(group_type=="All","all children",
if_else(group_type=="All_Other","all other children",
if_else(group_type=="SEN","children identified as SEN", tolower(take_up_ages))
)))
selected_gap_type<- if_else(gap_type=="Within the LA: gap with all other children",paste0("all other children in ",LA),
if_else(gap_type=="National average: gap with all other children","all other children",
if_else(gap_type=="National average: gap with FSM children","children known to be eligible for FSM","")))
# added to differentiate between percenatge gap (within LA) and percentage point gap (every other gap)
#return here tomorrow
# perc_or_perc_point_gap<- if_else(selected_gap_type==paste0("all other children in ",LA),"percentage gap","percentage point gap")
#Which group do we need to compare the chosen group with?
gap_comparison_group=if_else(group_type== "FSM" ,selected_gap_type,
if_else(group_type== "All_Other","all other children",
if_else(group_type=="All", "all children", "children identified as SEN",
if_else(group_type=="SEN","children identified as SEN", tolower(take_up_ages))
)))
#For CL and Lit combined use all
gap_comparison_group<-if_else(AoL_type=="CL_and_Lit","All", gap_comparison_group)
measure<-   case_when(
GLD_or_AoL_or_take_up=="GLD" ~ "achieving a GLD at EYFSP",
GLD_or_AoL_or_take_up=="AoL" ~ paste0("achieving at least the expected level of development at EYFSP for ",tolower(AoL_type)),
GLD_or_AoL_or_take_up=="Take_up" ~ " benefitting from funded early educational places"
)
if(neighbour_gap_context=="context")  {
title<- if_else(group=="FSM",paste0("Comparison of the percentage of children known to be eligible for FSM in ",LA," with national percentage.	"),
paste0("Comparison of children identified as SEN in ",LA," with national percentage.	"))
}
if(neighbour_gap_context=="neighbour")    {
title<- paste0("The percentage of ",title_group," within ", LA," ",measure,", compared with the 10 nearest statistical neighbours	.")
}
perc_or_perc_point_gap
if(neighbour_gap_context=="neighbour_gap")    {
title<- paste0("The percentage gap between ",title_group," within ", LA," and the national average for ",gap_comparison_group," ",measure,", compared with the 10 nearest statistical neighbours.")
# title<- paste0("The ",perc_or_perc_point_gap," between ",title_group," within ", LA," and the national average for ",gap_comparison_group," ",measure,", compared with the 10 nearest statistical neighbours.")
}
}
title_aol_2<- get_graph_title(LA="Bury", group="FSM", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="AoL",AoL_type = "CL",gap_type="National average: gap with FSM children")
get_graph_title <- function(LA, C="",group="", neighbour_gap_context,GLD_or_AoL_or_take_up="",Percent_or_Gap="",AoL_type="",gap_type="",take_up_ages=""){
# The purpose of this function is to give the graph titles for the neighbours and neighbours gaps graph as well as the context graph
# Variables
#   LA                      - user selected LA
#   neighbour_gap_context   - takes values "neighbour", "neighbour_gap", "context"
#   Percent_or_Gap          - "Percent"
#   AoL_type                - Takes the user selected AoL Type
#   gap_type                - For FSM only, takes user selected gap type
#   take_up_ages            - For take up, takes user selected age range
# Examples
# title_gld<- get_graph_title(LA="Bury", group="FSM", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="GLD",gap_type="National average: gap with FSM children")
# title_gld_2<- get_graph_title(LA="Bury", group="All", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="GLD")
# title_aol<- get_graph_title(LA="Bury", group="All", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="AoL")
# title_aol_2<- get_graph_title(LA="Bury", group="FSM", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="AoL",AoL_type = "CL",gap_type="National average: gap with FSM children")
group_type<-if_else(group=="All Other","All_Other"
,if_else(group=="All","All",group))
title_group=if_else(group_type=="FSM","children known to be eligible for FSM",
if_else(group_type=="All","all children",
if_else(group_type=="All_Other","all other children",
if_else(group_type=="SEN","children identified as SEN", tolower(take_up_ages))
)))
selected_gap_type<- if_else(gap_type=="Within the LA: gap with all other children",paste0("all other children in ",LA),
if_else(gap_type=="National average: gap with all other children","all other children",
if_else(gap_type=="National average: gap with FSM children","children known to be eligible for FSM","")))
# added to differentiate between percenatge gap (within LA) and percentage point gap (every other gap)
#return here tomorrow
# perc_or_perc_point_gap<- if_else(selected_gap_type==paste0("all other children in ",LA),"percentage gap","percentage point gap")
#Which group do we need to compare the chosen group with?
gap_comparison_group=if_else(group_type== "FSM" ,selected_gap_type,
if_else(group_type== "All_Other","all other children",
if_else(group_type=="All", "all children", "children identified as SEN",
if_else(group_type=="SEN","children identified as SEN", tolower(take_up_ages))
)))
#For CL and Lit combined use all
gap_comparison_group<-if_else(AoL_type=="CL_and_Lit","All", gap_comparison_group)
measure<-   case_when(
GLD_or_AoL_or_take_up=="GLD" ~ "achieving a GLD at EYFSP",
GLD_or_AoL_or_take_up=="AoL" ~ paste0("achieving at least the expected level of development at EYFSP for ",tolower(AoL_type)),
GLD_or_AoL_or_take_up=="Take_up" ~ " benefitting from funded early educational places"
)
if(neighbour_gap_context=="context")  {
title<- if_else(group=="FSM",paste0("Comparison of the percentage of children known to be eligible for FSM in ",LA," with national percentage.	"),
paste0("Comparison of children identified as SEN in ",LA," with national percentage.	"))
}
if(neighbour_gap_context=="neighbour")    {
title<- paste0("The percentage of ",title_group," within ", LA," ",measure,", compared with the 10 nearest statistical neighbours	.")
}
if(neighbour_gap_context=="neighbour_gap")    {
title<- paste0("The percentage gap between ",title_group," within ", LA," and the national average for ",gap_comparison_group," ",measure,", compared with the 10 nearest statistical neighbours.")
# title<- paste0("The ",perc_or_perc_point_gap," between ",title_group," within ", LA," and the national average for ",gap_comparison_group," ",measure,", compared with the 10 nearest statistical neighbours.")
}
}
title_aol_2<- get_graph_title(LA="Bury", group="FSM", neighbour_gap_context="neighbour_gap",GLD_or_AoL_or_take_up="AoL",AoL_type = "CL",gap_type="National average: gap with FSM children")
title_aol_2
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
